Sub Multiple_Year_Stock()'Set the initials variablesFor Each ws In WorksheetsDim Ticker As StringDim Open_Price As DoubleDim Close_Price As DoubleDim Total_Vol As DoubleTotal_Vol = 0'Find out the last row of the sheetsDim Lastrow As LongLastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row'Set up the Summary tableDim Summary_Table_Row As IntegerSummary_Table_Row = 2ws.Cells(1, 10).Value = "Ticker"ws.Cells(1, 11).Value = "Price_Yearly_Change"ws.Cells(1, 12).Value = "Price_Percent_Change"ws.Cells(1, 13).Value = "Total_Vol"Dim Price_Change As DoubleDim Percentage_Change As Double'Set a dummy variable to find out the open price of each tickerDim YY As IntegerYY = 0Dim i As LongFor i = 2 To Lastrow               If ws.Cells(i + 1, 1).Value = ws.Cells(i, 1).Value And YY = 0 Then               Open_Price = ws.Cells(i, 3).Value               YY = 1               End If        'put the ticker, price change, percentage change, and stock volume in the summary table                       If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value And Open_Price <> 0 Then               Ticker = ws.Cells(i, 1).Value               ws.Range("J" & Summary_Table_Row).Value = Ticker               Close_Price = ws.Cells(i, 6).Value               Price_Change = Close_Price - Open_Price        Percentage_Change = Price_Change / Open_Price               Total_Vol = Total_Vol + ws.Cells(i, 7).Value               ws.Range("K" & Summary_Table_Row).Value = Price_Change                   If Price_Change > 0 Then                       ws.Range("K" & Summary_Table_Row).Interior.ColorIndex = 4                       ElseIf Price_Change < 0 Then                       ws.Range("K" & Summary_Table_Row).Interior.ColorIndex = 3                       End If               ws.Range("L" & Summary_Table_Row).Value = Percentage_Change                   If Percentage_Change > 0 Then                       ws.Range("L" & Summary_Table_Row).Interior.ColorIndex = 4                       ElseIf Percentage_Change < 0 Then                       ws.Range("L" & Summary_Table_Row).Interior.ColorIndex = 3                       End If               ws.Range("M" & Summary_Table_Row).Value = Total_Vol             Summary_Table_Row = Summary_Table_Row + 1               Total_Vol = 0               YY = 0               ElseIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value And Open_Price = 0 Then               Ticker = ws.Cells(i, 1).Value               ws.Range("J" & Summary_Table_Row).Value = Ticker               Close_Price = ws.Cells(i, 6).Value               Price_Change = Close_Price - Open_Price               Total_Vol = Total_Vol + ws.Cells(i, 7).Value               ws.Range("K" & Summary_Table_Row).Value = Price_Change               ws.Range("L" & Summary_Table_Row).Value = "N/A"               ws.Range("M" & Summary_Table_Row).Value = Total_Vol             Summary_Table_Row = Summary_Table_Row + 1               Total_Vol = 0               YY = 0               Else        Total_Vol = Total_Vol + ws.Cells(i, 7).Value               End If       Next iws.Cells(1, 15).Value = "Greatest % Increase"ws.Cells(2, 15).Value = "Greatest % Decrease"ws.Cells(3, 15).Value = "Greatset Total Volume"'set Greatest%Increase, Greatest%Decrease, GreatestTolVol as variableDim Greatest_P_Increase, Greatest_P_Decrease, Greatest_Tol_Vol As DoubleGreatest_P_Increase = ws.Cells(2, 12).ValueGreatest_P_Decrease = ws.Cells(2, 12).ValueGreatest_Tol_Vol = ws.Cells(2, 13).Value'find last row in summary tableDim Sum_Lastrow As IntegerSum_Lastrow = ws.Cells(Rows.Count, 10).End(xlUp).Row'set summary table row number as rDim r As Integer'find the greatest % changeFor r = 2 To Sum_Lastrow    If ws.Cells(r, 12).Value > Greatest_P_Increase And ws.Cells(r, 12).Value <> "N/A" Then        Greatest_P_Increase = ws.Cells(r, 12).Value       ws.Cells(1, 16).Value = Greatest_P_Increase       End If       If ws.Cells(r, 12).Value < Greatest_P_Decrease And ws.Cells(r, 12).Value <> "N/A" Then        Greatest_P_Decrease = ws.Cells(r, 12).Value       ws.Cells(2, 16).Value = Greatest_P_Decrease       End If       If ws.Cells(r, 13).Value > Greatest_Tol_Vol Then       Greatest_Tol_Vol = ws.Cells(r, 13).Value       ws.Cells(3, 16).Value = Greatest_Tol_Vol       End If   Next rNext wsEnd Sub